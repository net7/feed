js.utils.registerNamespace("eu.europeana.header");eu.europeana.header={init:function(){this.addQueryFocus();this.addLanguageChangeHandler();this.addAutocompleteHandler();this.addRefineSearchClickHandler();this.addAjaxMethods();this.addMenuFocusTriggers();jQuery("#save-search").bind("click",this.handleSaveSearchClick);jQuery("#query-search").bind("submit",this.handleSearchSubmit);},addMenuFocusTriggers:function(){jQuery("#menu-main li ul li a").focusin(function(){jQuery(this).parent().parent().css({"margin-top":0,opacity:1});jQuery(this).parent().parent().prev().children().eq(0).css({color:"#fff","background-color":"#000","background-position":"right -189px"});}).focusout(function(){jQuery(this).parent().parent().css({"margin-top":-499,opacity:0});jQuery(this).parent().parent().prev().children().eq(0).css({color:"#000","background-color":"#fff","background-position":"right -173px"});});},addQueryFocus:function(){var b=["full-doc.html","login.html","forgotPassword.html","register-success.html"],a,d=b.length,c=true;for(a=0;a<d;a+=1){if(b[a]===eu.europeana.vars.page_name){c=false;break;}}if(c){jQuery("#query-input").focus();}},addAutocompleteHandler:function(){if(js.debug){jQuery("#query-input, #rq").autocomplete({delay:200,source:function(b,a){jQuery.getJSON("/"+eu.europeana.vars.portal_name+"/suggestions.json",b,function(d){var c=[];jQuery.each(d.suggestions,function(e,f){c.push(f);});a(c);});},select:function(a){switch(this.id){case"query-input":setTimeout(function(){jQuery("#query-search").submit();},10);break;case"rq":setTimeout(function(){jQuery("#refine-search-form").submit();},10);break;}}});}else{jQuery("#query-input").autocomplete({source:function(b,a){jQuery.getJSON("/"+eu.europeana.vars.portal_name+"/suggestions.json",b,function(d){var c=[];jQuery.each(d.suggestions,function(e,f){c.push(f);});a(c);});}});}},addLanguageChangeHandler:function(){jQuery("#embeddedlang").change(function(){jQuery("#language-selector").submit();});},addRefineSearchClickHandler:function(){jQuery("#refine-search").click(function(a){a.preventDefault();jQuery("#refine-search-form").fadeIn();jQuery("#rq").focus();});jQuery("#close-refine-search").click(function(a){a.preventDefault();jQuery("#refine-search-form").fadeOut();});},addAjaxMethods:function(){eu.europeana.ajax.methods=new eu.europeana.ajax();eu.europeana.ajax.methods.init();},handleSearchSubmit:function(a){if(jQuery("#query-input").val().length<1){a.preventDefault();jQuery("#query-input").addClass("error-border");jQuery("#additional-feedback").addClass("error").html(eu.europeana.vars.msg.search_error);}},handleSaveSearchClick:function(c){c.preventDefault();var b={saved_searches_count:0,$saved_searches:jQuery("#saved-searches-count"),success:function(){var d="<span>"+eu.europeana.vars.msg.search_saved+"</span>";eu.europeana.ajax.methods.addFeedbackContent(d);eu.europeana.ajax.methods.showFeedbackContainer();b.saved_searches_count=parseInt(b.$saved_searches.html(),10);b.$saved_searches.html(b.saved_searches_count+1);},failure:function(){var d='<span id="save-search-feedback" class="error">'+eu.europeana.vars.msg.search_save_failed+"</span>";eu.europeana.ajax.methods.addFeedbackContent(d);eu.europeana.ajax.methods.showFeedbackContainer();}},a={className:"SavedSearch",query:jQuery("#query-to-save").val(),queryString:jQuery("#query-string-to-save").val()};eu.europeana.ajax.methods.user_panel("save",a,b);}};eu.europeana.header.init();