js.utils.registerNamespace("com.gmtplusone.truncate");com.gmtplusone.truncate=function(c,a){var d={target:"#container",limit:{pixels:100,percent:0.33,use_pixels:true},toggle_html:{container:'<a href=""></a>',more:"show more ...",less:"show less ...",more_class:"",less_class:""}},b={$target:{}};this.options=jQuery.extend(true,{},d,a);this.options.target=("string"===typeof c)?c:this.options.target;b.$target=jQuery(this.options.target);com.gmtplusone.truncate.prototype.init=function(f){var e={};e.total=b.$target.outerHeight(true);e.line=parseInt(b.$target.css("line-height"),10);e.truncated=this.getTruncatedHeight(e);if(e.total>e.truncated){b.$target.css("height",e.truncated).slideDown().after(this.options.toggle_html.container).next().html(this.options.toggle_html.more).addClass(this.options.toggle_html.more_class).bind("click",{self:this,height:e},this.handleToggleClick);}else{b.$target.css("display","block");}if(f){f.call();}};com.gmtplusone.truncate.prototype.handleToggleClick=function(h){var g=h.data.self,f=h.data.height;h.preventDefault();if(b.$target.outerHeight(true)<f.total){b.$target.next().html(g.options.toggle_html.less);b.$target.next().removeClass(g.options.toggle_html.more_class);b.$target.next().addClass(g.options.toggle_html.less_class);b.$target.animate({height:f.total},500);}else{b.$target.next().html(g.options.toggle_html.more);b.$target.next().removeClass(g.options.toggle_html.less_class);b.$target.next().addClass(g.options.toggle_html.more_class);b.$target.animate({height:f.truncated},500);}};com.gmtplusone.truncate.prototype.getTruncatedHeight=function(e){var f=0;if(this.options.limit.use_pixels){f=Math.floor(this.options.limit.pixels/e.line)*e.line;}else{if(!isNaN(parseFloat(this.options.limit.percent))){f=Math.floor(e.total*this.options.limit.percent);}}return f;};};